from cohortextractor import (
    StudyDefinition,
    codelist,
    codelist_from_csv,
    combine_codelists,
    patients,
)
from codelists import *

dfm_indications=patients.with_these_clinical_events(
        ind_codes,
        between=["index_date", "last_day_of_month(index_date)"],
        returning="category",
        return_expectations={
            "rate": "universal",
            "category": {
                "ratios": {
                    "274663001": 0.008,
                    "386449006": 0.008,
                    "83482000": 0.008,
                    "192080009": 0.008,
                    "161891005": 0.008,
                    "134407002": 0.008,
                    "736464002": 0.008,
                    "274665008": 0.008,
                    "278860009": 0.008,
                    "144951000000106": 0.008,
                    "735644008": 0.008,
                    "3061000119102": 0.008,
                    "235841007": 0.008,
                    "82423001": 0.008,
                    "431481001": 0.008,
                    "1362941000000102": 0.008,
                    "860381000000107": 0.008,
                    "237067000": 0.008,
                    "279032003": 0.008,
                    "128200000": 0.008,
                    "36630001": 0.008,
                    "49218002": 0.008,
                    "279039007": 0.008,
                    "68962001": 0.008,
                    "22253000": 0.008,
                    "10601006": 0.008,
                    "76948002": 0.008,
                    "30077003": 0.008,
                    "21897009": 0.008,
                    "836551000000102": 0.008,
                    "445455005": 0.008,
                    "272025006": 0.008,
                    "44186003": 0.008,
                    "440313002": 0.008,
                    "83157008": 0.008,
                    "59050008": 0.008,
                    "326781000000101": 0.008,
                    "41975002": 0.008,
                    "162204000": 0.008,
                    "67233009": 0.008,
                    "192454004": 0.008,
                    "191997003": 0.008,
                    "39898005": 0.008,
                    "193462001": 0.008,
                    "268652009": 0.008,
                    "310495003": 0.008,
                    "87512008": 0.008,
                    "79298009": 0.008,
                    "237349002": 0.008,
                    "231504006": 0.008,
                    "191610000": 0.008,
                    "310496002": 0.008,
                    "832007": 0.008,
                    "15639000": 0.008,
                    "103014001": 0.008,
                    "11679003": 0.008,
                    "16269008": 0.008,
                    "103015000": 0.008,
                    "762602002": 0.008,
                    "944141000000108": 0.008,
                    "247398009": 0.008,
                    "279981003": 0.008,
                    "810601000000106": 0.008,
                    "191736004": 0.008,
                    "191722009": 0.008,
                    "61569007": 0.008,
                    "225624000": 0.008,
                    "371631005": 0.008,
                    "450356003": 0.008,
                    "76105009": 0.008,
                    "26665006": 0.008,
                    "231528008": 0.008,
                    "37746008": 0.008,
                    "20010003": 0.008,
                    "442057004": 0.008,
                    "473456000": 0.008,
                    "84466009": 0.008,
                    "1084061000000106": 0.008,
                    "943161000000107": 0.008,
                    "44376007": 0.008,
                    "191496002": 0.008,
                    "191772006": 0.008,
                    "191765005": 0.008,
                    "231527003": 0.008,
                    "55341008": 0.008,
                    "191753006": 0.008,
                    "191773001": 0.008,
                    "268633003": 0.008,
                    "231525006": 0.008,
                    "191774007": 0.008,
                    "31611000": 0.008,
                    "80711002": 0.008,
                    "473457009": 0.008,
                    "1376001": 0.008,
                    "36217008": 0.008,
                    "13601005": 0.008,
                    "44966003": 0.008,
                    "33449004": 0.008,
                    "231530005": 0.008,
                    "268634009": 0.008,
                    "52954000": 0.008,
                    "31027006": 0.008,
                    "273844008": 0.008,
                    "191676002": 0.008,
                    "274647009": 0.008,
                    "247366003": 0.008,
                    "307176005": 0.008,
                    "273206005": 0.008,
                    "307177001": 0.008,
                    "202794004": 0.008,
                    "311804006": 0.008,
                    "23056005": 0.008,
                    "765176007": 0.008,
                    "764611000000100": 0.008,
                    "310497006": 0.008,
                    "73867007": 0.008,
                    "75084000": 0.008,
                    "251000119105": 0.008,
                    "28475009": 0.01,
                    "36474008": 0.01,

                },
            },
        },
    ),
indication_variables = dict(
    dfm_indication=patients.categorised_as(
        {
            "0": "DEFAULT",
            "acute_pain": "indication = '274663001'",
            "alcohol_withdrawal": "indication = '386449006'",
            "body_dysmorphic_disorder": "indication = '83482000'",
            "chronic_depression": "[indication = '192080009', '161891005', \
                '134407002', '736464002', '274665008', '278860009', \
                '144951000000106', '735644008', '3061000119102', \
                '23584100782423001', '431481001', '1362941000000102', \
                '860381000000107', '237067000', '279032003', '128200000', \
                '36630001', '49218002', '279039007', '68962001','22253000', \
                '10601006', '76948002', '30077003']",
            "generalised_anxiety": "[indication = '21897009', \
                '836551000000102', '445455005']",
            "insomnia": "[indication = '272025006', '44186003', '440313002', \
                '83157008', '59050008', '326781000000101', '41975002', \
                '162204000', '67233009', '192454004', '191997003', '39898005', \
                '193462001', '268652009']",
            "mild_depression": "[indication =  '310495003', '87512008', \
                '79298009', '237349002', '231504006', '191610000']",
            "moderate_depression": "[indication = '310496002', '832007', \
                '15639000']",
            "nerve_pain": "[indication = '103014001', '11679003', '16269008', \
                '103015000']",
            "neuropathic_pain": "[indication = '762602002', '944141000000108' \
                '247398009', '279981003', '810601000000106']",
            "panic_disorder": "[indication = '191722009', '61569007', \
                '225624000', '371631005', '450356003']",
            "ocd": "indication = '191736004'",
            "personality_disorder": "[indication = '76105009', '26665006', \
                '231528008', '37746008', '20010003', '442057004', '473456000 \
                '84466009', '1084061000000106', '943161000000107', '44376007' \
                '191496002', '191772006', '191765005', '231527003', '55341008' \
                '191753006', '191773001', '268633003', '231525006', \
                '191774007', '31611000', '80711002', '473457009', '1376001', \
                '36217008', '13601005', '44966003', '33449004', '231530005', \
                '268634009', '52954000', '31027006', '273844008']",
            "psychotic_depression": "indication = '191676002'",
            "restlessness_and_agitation": "indication = '274647009'",
            "sciatica": "[indication = '247366003', '307176005', 273206005', \
                '307177001', '202794004', '311804006', '23056005']",
        },
        return_expectations={
            "category": {
                "ratios": {
                    "0": 0.02,
                    "acute_pain": 0.07,
                    "alcohol_withdrawal": 0.07,
                    "body_dysmorphic_disorder": 0.08,
                    "chronic_depression": 0.08,
                    "generalised_anxiety": 0.08,
                    "mild_depression": 0.08,
                    "moderate_depression": 0.04,
                    "nerve_pain": 0.08,
                    "neuropathic_pain": 0.04,
                    "panic_disorder": 0.08,
                    "ocd": 0.08,
                    "personality_disorder": 0.06,
                    "psychotic_depression": 0.06,
                    "restlessness_and_agitation": 0.04,
                    "sciatica": 0.04,
                }
            },
            "incidence": 0.2,
        },  
    ),
)
