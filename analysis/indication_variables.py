from cohortextractor import (
    StudyDefinition,
    codelist,
    codelist_from_csv,
    combine_codelists,
    patients,
)
from codelists import *

indications=patients.with_these_clinical_events(
        ind_codes,
        between=["index_date", "last_day_of_month(index_date)"],
        returning="category",
        return_expectations={
            "rate": "universal",
            "category": {
                "ratios": {
                    "274663001": 0.008,
                    "386449006": 0.008,
                    "83482000": 0.008,
                    "192080009": 0.008,
                    "161891005": 0.008,
                    "134407002": 0.008,
                    "736464002": 0.008,
                    "274665008": 0.008,
                    "278860009": 0.008,
                    "144951000000106": 0.008,
                    "735644008": 0.008,
                    "3061000119102": 0.008,
                    "235841007": 0.008,
                    "82423001": 0.008,
                    "431481001": 0.008,
                    "1362941000000102": 0.008,
                    "860381000000107": 0.008,
                    "237067000": 0.008,
                    "279032003": 0.008,
                    "128200000": 0.008,
                    "36630001": 0.008,
                    "49218002": 0.008,
                    "279039007": 0.008,
                    "68962001": 0.008,
                    "22253000": 0.008,
                    "10601006": 0.008,
                    "76948002": 0.008,
                    "30077003": 0.008,
                    "21897009": 0.008,
                    "836551000000102": 0.008,
                    "445455005": 0.008,
                    "272025006": 0.008,
                    "44186003": 0.008,
                    "440313002": 0.008,
                    "83157008": 0.008,
                    "59050008": 0.008,
                    "326781000000101": 0.008,
                    "41975002": 0.008,
                    "162204000": 0.008,
                    "67233009": 0.008,
                    "192454004": 0.008,
                    "191997003": 0.008,
                    "39898005": 0.008,
                    "193462001": 0.008,
                    "268652009": 0.008,
                    "310495003": 0.008,
                    "87512008": 0.008,
                    "79298009": 0.008,
                    "237349002": 0.008,
                    "231504006": 0.008,
                    "191610000": 0.008,
                    "310496002": 0.008,
                    "832007": 0.008,
                    "15639000": 0.008,
                    "103014001": 0.008,
                    "11679003": 0.008,
                    "16269008": 0.008,
                    "103015000": 0.008,
                    "762602002": 0.008,
                    "944141000000108": 0.008,
                    "247398009": 0.008,
                    "279981003": 0.008,
                    "810601000000106": 0.008,
                    "191736004": 0.008,
                    "191722009": 0.008,
                    "61569007": 0.008,
                    "225624000": 0.008,
                    "371631005": 0.008,
                    "450356003": 0.008,
                    "76105009": 0.008,
                    "26665006": 0.008,
                    "231528008": 0.008,
                    "37746008": 0.008,
                    "20010003": 0.008,
                    "442057004": 0.008,
                    "473456000": 0.008,
                    "84466009": 0.008,
                    "1084061000000106": 0.008,
                    "943161000000107": 0.008,
                    "44376007": 0.008,
                    "191496002": 0.008,
                    "191772006": 0.008,
                    "191765005": 0.008,
                    "231527003": 0.008,
                    "55341008": 0.008,
                    "191753006": 0.008,
                    "191773001": 0.008,
                    "268633003": 0.008,
                    "231525006": 0.008,
                    "191774007": 0.008,
                    "31611000": 0.008,
                    "80711002": 0.008,
                    "473457009": 0.008,
                    "1376001": 0.008,
                    "36217008": 0.008,
                    "13601005": 0.008,
                    "44966003": 0.008,
                    "33449004": 0.008,
                    "231530005": 0.008,
                    "268634009": 0.008,
                    "52954000": 0.008,
                    "31027006": 0.008,
                    "273844008": 0.008,
                    "191676002": 0.008,
                    "274647009": 0.008,
                    "247366003": 0.008,
                    "307176005": 0.008,
                    "273206005": 0.008,
                    "307177001": 0.008,
                    "202794004": 0.008,
                    "311804006": 0.008,
                    "23056005": 0.008,
                    "765176007": 0.008,
                    "764611000000100": 0.008,
                    "310497006": 0.008,
                    "73867007": 0.008,
                    "75084000": 0.008,
                    "251000119105": 0.008,
                    "28475009": 0.028,
                    "36474008": 0.028,
                },
            },
        },
    ),
indication_variables = dict(
    indication=patients.categorised_as(
        {
            "other": "DEFAULT",
            "acute_pain": """274663001""",
            "alcohol_withdrawal": """386449006""",
            "body_dysmorphic_disorder": """83482000""",
            "chronic_depression": """192080009 OR 161891005 OR 134407002 OR \
                736464002 OR 274665008 OR 278860009 OR 144951000000106 OR \
                735644008 OR 3061000119102 OR 23584100782423001 OR 431481001 \
                OR 1362941000000102 OR 860381000000107 OR 237067000 OR \
                279032003 OR 128200000 OR 36630001 OR 49218002 OR 279039007 OR \
                68962001 OR 22253000 OR 10601006 OR 76948002 OR 30077003""",
            "generalised_anxiety": """21897009 OR 836551000000102 OR \
                445455005""",
            "insomnia": """272025006 OR 44186003 OR 440313002 OR 83157008 OR \
                59050008 OR 326781000000101 OR 41975002 OR 162204000 OR \
                67233009 OR 192454004 OR 191997003 OR 39898005 OR \
                193462001 OR 268652009""",
            "mild_depression": """310495003 OR 87512008 OR 79298009 OR \
                237349002 OR 231504006 OR 191610000""",
            "moderate_depression": """310496002 OR 832007 OR 15639000""",
            "nerve_pain": """103014001 OR 11679003 OR 16269008 OR 103015000""",
            "neuropathic_pain": """762602002 OR 944141000000108 OR 247398009 \
                OR 279981003 OR 810601000000106""",
            "panic_disorder": """191722009 OR 61569007 OR 225624000 OR \
                371631005 OR 450356003""",
            "ocd": """191736004""",
            "personality_disorder": """76105009 OR 26665006 OR 231528008 OR \
                37746008 OR 20010003 OR 442057004 OR 473456000 OR 84466009 OR \
                1084061000000106 OR 943161000000107 OR 44376007 OR 191496002 \
                OR 191772006 OR 191765005 OR 231527003 OR 55341008 OR \
                191753006 OR 191773001 OR 268633003 OR 231525006 OR 191774007 \
                OR 31611000 OR 80711002 OR 473457009 OR 1376001 OR 36217008 \
                OR 3601005 OR 44966003 OR 33449004 OR 231530005 OR 268634009 \
                OR 52954000 OR 31027006 OR 273844008""",
            "psychotic_depression": """191676002""",
            "restlessness_and_agitation": """274647009""",
            "sciatica": """247366003 OR 307176005 OR 273206005 OR 307177001 OR \
                202794004 OR 311804006 OR 23056005""",
        },
        return_expectations={
            "category": {
                "ratios": {
                    "other": 0.06,
                    "acute_pain": 0.06,
                    "alcohol_withdrawal": 0.06,
                    "body_dysmorphic_disorder": 0.06,
                    "chronic_depression": 0.06,
                    "generalised_anxiety": 0.06,
                    "insomnia": 0.06,
                    "mild_depression": 0.06,
                    "moderate_depression": 0.06,
                    "nerve_pain": 0.06,
                    "neuropathic_pain": 0.06,
                    "panic_disorder": 0.06,
                    "ocd": 0.06,
                    "personality_disorder": 0.06,
                    "psychotic_depression": 0.06,
                    "restlessness_and_agitation": 0.05,
                    "sciatica": 0.05,
                }
            },
        },  
    ),
)
# print(indications)